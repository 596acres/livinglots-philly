{% extends "lots/map/cluster_main.html" %}

{% block below_map %}
<form>
    {{ filters.as_p }}
</form>

<script>
    $(document).ready(function() {

        LOTS_MAP.on('moveend', function(e) {
            var g = JSON.stringify(LOTS_MAP.getBounds().toGeoJson())
            $(':input[name="centroid__within"]').val(
                JSON.stringify(LOTS_MAP.getBounds().toGeoJson())
            );
            // TODO update counts/tally
        });

        // TODO initialize counts/tally

        $(':input').change(function() {
            // TODO update counts/tally
            LOTS_MAP.reloadLotCentroidLayer($('form').serialize());
        });

    });
</script>
{% endblock %}
